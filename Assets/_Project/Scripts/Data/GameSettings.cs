using System.Collections.Generic;
using _Project.Scripts.Level;
using DG.Tweening;
using Sirenix.OdinInspector;
using UnityEngine;

namespace _Project.Scripts.Data
{
    [CreateAssetMenu(menuName = "Settings/Game Setting", fileName = "New Game Settings")]
    public class GameSettings : ScriptableObject
    {
        [TabGroup("General")] [Header("GAME")] public int defaultLevelEarnMoneyCount = 30;

        [TabGroup("General")] public float levelCompletedUIDelay = 1f;

        [TabGroup("General")] public float levelFailedUIDelay = 2f;

        [Space(15)] [TabGroup("General")] [Header("LEVEL SYSTEM")]
        public int randomStartIndex = 3;

        [Space(15)] [TabGroup("General")] [Header("SHOOTER SETTINGS")]
        public float shooterSpeed = 3;

        [TabGroup("General")] public float lastShooterEffectTimeScale = 2f;
        [Space(10)] [TabGroup("General")] public float shooterSlotToConveyorJumpDuration = 0.5f;
        [TabGroup("General")] public float shooterSlotToConveyorJumpPower = 1f;
        [TabGroup("General")] public Ease shooterSlotToConveyorJumpEase = Ease.Linear;
        [Space(10)] [TabGroup("General")] public float shooterToReservedSlotJumpDuration = 0.5f;
        [TabGroup("General")] public float shooterToReservedSlotJumpPower = 1f;
        [TabGroup("General")] public Ease shooterToReservedSlotJumpEase = Ease.Linear;
        [Space(10)] [TabGroup("General")] public float shooterNodeTransferDuration = 0.3f;
        [TabGroup("General")] public Ease shooterNodeTransferEase = Ease.Linear;
        [Space(10)] [TabGroup("General")] public float shooterCompleteEffectZPositionPlusValue = 1f;
        [TabGroup("General")] public float shooterCompleteEffectDuration = 0.5f;
        [TabGroup("General")] public Ease shooterCompleteEffectScaleDownEase = Ease.InBack;
    [Space(10)]
    [TabGroup("General")] public float shooterFireEffectZValue = 0.05f;
    [TabGroup("General")] public float shooterFireEffectDuration = 0.15f;
    [TabGroup("General")] public Vector3 shooterFireEffectStrength = new Vector3(2f, 2f, 2f);
    [TabGroup("General")] public int shooterFireEffectVibrato = 10;
    [TabGroup("General")] public float shooterFireEffectRandomness = 90f;
    
    

        [Space(15)] [TabGroup("General")] [Header("BULLET SETTINGS")]
        public float bulletSpeed = 3f;

        [TabGroup("General")] public Ease bulletFireEase = Ease.Linear;
        [TabGroup("General")] public float bulletScaleDownDuration = 0.1f;


        [Space(15)] [TabGroup("General")] [Header("CONVEYOR SETTINGS")]
        public int conveyorShooterLimit = 5;

        [TabGroup("General")] public int conveyorArrowCount;
        [TabGroup("General")] public float conveyorArrowSpeed = 5f;

        [Space(10)] [TabGroup("General")] public Color conveyorIsFullEffectTextColor = Color.red;
        [TabGroup("General")] public float conveyorIsFullEffectTextColorChangeDuration = 0.3f;
        [TabGroup("General")] public float conveyorIsFullEffectTextShakeDuration = 0.35f;
        [TabGroup("General")] public Vector3 conveyorIsFullEffectTextShakeStrength = new Vector3(0.05f, 0.05f, 0f);
        [TabGroup("General")] public int conveyorIsFullEffectTextShakeVibrato = 12;
        [TabGroup("General")] public float conveyorIsFullEffectTextShakeRandomness = 60f;
        [TabGroup("General")] public float conveyorIsFullEffectTextColorFixDuration = 0.2f;
        [Space(10)] [TabGroup("General")] public float conveyorShooterPlatePositionDistance = 0.1f;
        [TabGroup("General")] public float plateMoveDuration = 0.3f;

        [Space(15)] [TabGroup("General")] [Header("RESERVED SLOT SETTINGS")]
        public int reservedSlotCount = 5;

        [TabGroup("General")] public int reservedSlotWarningEffectCount = 2;
        [TabGroup("General")] public float reservedSlotWarningEffectDuration = 0.5f;

        [Space(15)] [TabGroup("General")] [Header("COLOR CUBE & TEXTURE SETTÄ°NGS")]
        public float defaultTextureWidth;

        [TabGroup("General")] public float defaultTextureHeight;


        [TabGroup("Levels")] [ListDrawerSettings(Expanded = true, DraggableItems = false, ShowIndexLabels = true)]
        public LevelData[] levels;

        public LevelData GetLevel(int index)
        {
            if (levels == null || levels.Length == 0)
            {
#if UNITY_EDITOR
                Debug.LogWarning("[GameSettings] Level list null or empty!");
#endif
                return null;
            }

            if (index >= 0 && index < levels.Length)
                return levels[index];

            if (randomStartIndex < 0 || randomStartIndex >= levels.Length)
            {
#if UNITY_EDITOR
                Debug.LogWarning($"[GameSettings] RandomStartIndex ({randomStartIndex}) is invalid, defaulting to 0.");
#endif
                randomStartIndex = 0;
            }

            int randomIndex = Random.Range(randomStartIndex, levels.Length);

#if UNITY_EDITOR
            Debug.Log($"[GameSettings] Level {index} -> randomly selected: {randomIndex}");
#endif

            return levels[randomIndex];
        }
    }
}